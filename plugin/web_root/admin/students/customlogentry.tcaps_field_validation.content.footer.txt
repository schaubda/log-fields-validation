<!-- Begin TCAPS Log Fields Validation Plugin -->
<script type="text/javascript">
    (function ()
    {
        let inputFields = $j('#content-main form div.box-round table:first :input');
        let fieldCount = 8;
        let fieldFuncs =
                {
                    2: 'validateReporterNameField',
                    3: 'validateReporterIDField'
                };

        for (let i = 0; i < fieldCount; i++)
        {
            $j(inputFields[i]).addClass('required');

            if (fieldFuncs[i] !== undefined)
            {
                $j(inputFields[i]).addClass('psSpecialValidate');
                $j(inputFields[i]).attr('data-specialfunction', fieldFuncs[i]);
            }
        }

        $j(inputFields[5]).removeClass('required');
    })();

    $j(function ()
       {
           let dateFields = $j('#content-main form div.box-round table:first :input')
               .slice(0, 2);

           dateFields.addClass('psDateWidget');

           logTypeChange();
           $j('#logtype').on('change', logTypeChange);
       });

    function validateReporterNameField(input)
    {
        let matchPattern = /.+, .+/;

        if (!matchPattern.test(input.val().trim()))
        {
            return 'This must be the reporter\'s name in the format "Last, First"';
        }
    }

    function validateReporterIDField(input)
    {
        let matchPattern = /^\d{5,7}$/;

        if (!matchPattern.test(input.val().trim()))
        {
            return 'This must be a valid employee number';
        }
    }

    function logTypeChange()
    {
        let logType = parseInt($j('#logtype').val());
        let inputFields = $j('#content-main form div.box-round table:first :input');
        let locationField = inputFields[8];
        let timeField = inputFields[9];

        if (logType === -100000)
        {
            $j(locationField).addClass('required');
            $j(timeField).addClass('required');
        }
        else
        {
            $j(locationField).removeClass('required unvalidated tagged hasHadError error');
            $j(timeField).removeClass('required unvalidated tagged hasHadError error');

            if ($j(locationField).nextAll('.error-message').length > 0)
            {
                clearError($j(locationField));
            }

            if ($j(timeField).nextAll('.error-message').length > 0)
            {
                clearError($j(timeField));
            }
        }

        initBehaviors();
    }
</script>
<!-- End TCAPS Log Fields Validation Plugin -->